!function(t){function e(i){if(s[i])return s[i].exports;var n=s[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var s={};e.m=t,e.c=s,e.p="",e(0)}([function(t,e,s){"use strict";function i(t,e,s){this.options=s||{};var i={historySize:50,unknownCover:"http://i.imgur.com/NpYCAVP.png"};for(var r in i)i.hasOwnProperty(r)&&!this.options.hasOwnProperty(r)&&(this.options[r]=i[r]);this.stream=new n(t,s),this.player=e,this.currentCover=0,this.historyFetched=0,this.historyUnfetched=0,this.history=[],this.state="paused",this.mutedState=!1,this.dom={player:"#player",coverParent:".cover",cover:".cover > .image",backgroundCover:".background-cover",artist:".artist",streamname:".streamname",streamer:".info > .meta > .streamer",songtitle:".songtitle",prevCoverButton:".info > .cover > .triangle.triangle-left",nextCoverButton:".info > .cover > .triangle.triangle-right",listeners:".info > .stats > .listeners",maxlisteners:".info > .stats > .maxlisteners",volume:".info > .volume > input[type=range]",canvas:".info > .cover > canvas"};for(var o in this.dom)this.dom.hasOwnProperty(o)&&(this.dom[o]=document.querySelector(this.dom[o]));this.ctx=null,this.dom.canvas&&(this.ctx=this.dom.canvas.getContext("2d")),this.animFrame=null,this.maxSpectrumHeight=.1,this.playButton=e.querySelector(".playbutton"),this.muteButton=e.querySelector(".mute"),this.stopButton=e.querySelector(".stop"),this.play=function(){"stopped"===this.state||"paused"===this.state?(this.stream.play(),this.state="playing",this.draw()):(this.stream.pause(),this.state="paused",window.cancelAnimationFrame(this.animFrame)),this.updateControls()},this.mute=function(){this.mutedState?this.stream.unmute():this.stream.mute(),this.mutedState=!this.mutedState,this.mutedState?this.muteButton.classList.add("muted"):this.muteButton.classList.remove("muted")},this.stop=function(){this.stream.audio.currentTime=0;var t=this.stream.audio.src;this.stream.audio.src="",this.stream.audio.src=t,this.state="stopped",this.updateControls()},this.updateControls=function(){"playing"===this.state?this.playButton.classList.add("paused"):"paused"===this.state?this.playButton.classList.remove("paused"):"stopped"===this.state&&(this.playButton.classList.remove("paused"),this.stopButton.classList.toggle("stopped"))},this.setCover=function(t){if(this.currentCover=t,this.history[0].fetched){0===t?this.dom.nextCoverButton.classList.add("disabled"):t===this.history.length-1?this.dom.prevCoverButton.classList.add("disabled"):(this.dom.prevCoverButton.classList.remove("disabled"),this.dom.nextCoverButton.classList.remove("disabled"));var e;this.history[t].fetched.hasOwnProperty("cover")?(e=this.history[t].fetched.cover,this.dom.songtitle.textContent=this.history[t].fetched.trackName,this.dom.artist.textContent=this.history[t].fetched.artist):(e=this.options.unknownCover,this.dom.songtitle.textContent=this.history[t].title.split(" - ")[0],this.dom.artist.textContent=this.history[t].title.split(" - ")[1]||" "),this.dom.cover.style.background="#323232 url('"+e+"') no-repeat 50% 50% / cover",this.dom.backgroundCover.style.background="#323232 url('"+e+"') no-repeat 50% 50%/auto 110%"}},this.draw=function(){this.analyser.getByteFrequencyData(this.frequency);for(var t=parseInt(this.dom.canvas.width/3),e=parseInt(.9*this.frequency.length/t),s=new Array(t),i=0;i<t;i++){var n=this.frequency.slice(e*i,e*(i+1));s[i]=this.maxSpectrumHeight*n.reduce(function(t,e){return t+e})/n.length}this.ctx.clearRect(0,0,this.dom.canvas.width,this.dom.canvas.height);var r=this.ctx.createLinearGradient(0,0,this.dom.canvas.width,0);r.addColorStop(0,"rgba(255, 255, 255, 0.2)"),r.addColorStop(.5,"rgba(255, 255, 255, 0.8)"),r.addColorStop(1,"rgba(255, 255, 255, 0.2)"),this.ctx.fillStyle=r;for(var i=0,o=0;i<s.length;i++,o+=3)this.ctx.fillRect(0,o,s[i],2),this.ctx.fillRect(this.dom.canvas.width,o,-s[i],2);this.animFrame=window.requestAnimationFrame(this.draw.bind(this))},this.initializeCanvas=function(){this.dom.canvas?(this.ctx.canvas.width=this.dom.coverParent.offsetWidth,this.ctx.canvas.height=this.dom.coverParent.offsetHeight,this.stream.audio.crossOrigin="anonymous",this.context=new AudioContext,this.analyser=this.context.createAnalyser(),this.analyser.connect(this.context.destination),this.source=this.context.createMediaElementSource(this.stream.audio),this.source.connect(this.analyser),this.analyser.connect(this.context.destination),this.frequency=new Uint8Array(this.analyser.frequencyBinCount)):console.log("Chuj")},this.nextCover=function(){return this.currentCover>0&&(this.currentCover--,this.setCover(this.currentCover)),this.currentCover},this.prevCover=function(){return this.currentCover<this.history.length-1&&(this.currentCover++,this.setCover(this.currentCover)),this.currentCover},this.updateVolume=function(t){this.stream.setVolume(t.target.value)},this.songExistsInHistory=function(t){for(var e=0;e<this.history.length;e++)if(t.playedat===this.history[e].playedat)return!0;return!1},this.mergeHistory=function(t){(t=t.reverse()).map(function(t){this.songExistsInHistory(t)||this.history.unshift(t)},this)},this.countUnfetched=function(){var t=0;return this.history.map(function(e){e.hasOwnProperty("fetched")||t++},this),t},this.playButton.addEventListener("click",this.play.bind(this)),this.muteButton.addEventListener("click",this.mute.bind(this)),this.stopButton.addEventListener("click",this.stop.bind(this)),this.dom.volume.addEventListener("input",this.updateVolume.bind(this)),this.dom.nextCoverButton.addEventListener("click",this.nextCover.bind(this)),this.dom.prevCoverButton.addEventListener("click",this.prevCover.bind(this)),document.addEventListener("statsFetched",function(t){t.detail.error||(this.dom.streamname.textContent=t.detail.response.servertitle,this.dom.streamer.textContent=t.detail.response.servergenre,this.dom.listeners.textContent=t.detail.response.currentlisteners,this.dom.maxlisteners.textContent=t.detail.response.maxlisteners)}.bind(this)),this.initializeCanvas(),document.addEventListener("historyFetched",function(t){var e=this;this.mergeHistory(t.detail.response),this.history.map(function(t){if(!t.hasOwnProperty("fetched")){this.historyUnfetched++;var s=new XMLHttpRequest;s.open("GET","https://itunes.apple.com/search?media=music&term="+t.title.replace(/,* +(|-|&)* */g,"+"),!0),s.addEventListener("readystatechange",function(){if(this.readyState===this.DONE&&200===this.status){var s=""!==this.responseText?JSON.parse(this.responseText):null;if(null!==s&&s.resultCount>0){var i=s.results[0];t.fetched={trackName:i.trackName,artist:i.artistName,cover:i.artworkUrl100}}else t.fetched={};e.historyFetched++,e.historyUnfetched===e.historyFetched&&(e.historyUnfetched=0,e.historyFetched=0,e.setCover(0))}}),s.send(null)}},this)}.bind(this))}var n=s(1);document.addEventListener("DOMContentLoaded",function(){window.player=new i("http://4stream.pl:18240",document.getElementById("player"))})},function(t,e,s){"use strict";function i(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return t.split("").map(function(t){return e[t]||t}).join("")}var n=s(2);t.exports=function(t,e){this.url=t,this.options=e||{};var s={historyTimeout:8e4,statsTimeout:4e4,path:{history:"/played",stats:"/stats"},streamID:1};for(var r in s)s.hasOwnProperty(r)&&!this.options.hasOwnProperty(r)&&(this.options[r]=s[r]);this.audio=new Audio(t+"/;"),this.statsFetchedEvent=new CustomEvent("statsFetched",{detail:null}),this.historyFetchedEvent=new CustomEvent("historyFetched",{detail:null}),this.statsInterval=null,this.historyInterval=null,this.mute=function(){this.audio.mute=!this.audio.mute},this.fetchStats=function(){n({url:this.url+this.options.path.stats+"?json=1&sid="+this.options.streamID,success:function(t){for(var e in t)t.hasOwnProperty(e)&&"string"==typeof t[e]&&(t[e]=i(t[e]));this.historyFetchedEvent=new CustomEvent("statsFetched",{detail:{response:t,error:null}}),document.dispatchEvent(this.historyFetchedEvent)},error:function(t){this.historyFetchedEvent=new CustomEvent("statsFetched",{detail:{response:null,error:t}}),document.dispatchEvent(this.historyFetchedEvent)}})},this.fetchHistory=function(){n({url:this.url+this.options.path.history+"?type=json",success:function(t){for(var e in t)t.hasOwnProperty(e)&&"string"==typeof t[e]&&(t[e]=i(t[e]));this.historyFetchedEvent=new CustomEvent("historyFetched",{detail:{response:t,error:null}}),document.dispatchEvent(this.historyFetchedEvent)},error:function(t){this.historyFetchedEvent=new CustomEvent("historyFetched",{detail:{response:null,error:t}}),document.dispatchEvent(this.historyFetchedEvent)}})},this.fetch=function(t,e){this.fetchHistory(e),this.fetchStats(t),this.statsInterval=setInterval(function(){this.fetchStats(t)}.bind(this),this.options.statsTimeout),this.historyInterval=setInterval(function(){this.fetchHistory(e)}.bind(this),this.options.historyTimeout)},this.stopFetching=function(){clearInterval(this.statsInterval),clearInterval(this.historyInterval)},this.play=function(){this.audio.play(),this.fetch(this.statsCallback,this.historyCallback)},this.pause=function(){this.audio.pause(),this.stopFetching()},this.mute=function(){this.audio.muted=!0},this.unmute=function(){this.audio.muted=!1},this.setVolume=function(t){return t>=0&&t<=1&&(this.audio.volume=t,!0)}}},function(t,e,s){var i;(function(t){(function(){var n,r,o,a,h,c,u,d;o=function(t){return window.document.createElement(t)},a=window.encodeURIComponent,u=Math.random,n=function(t){var e,s,i,n,a,c,u;if(null==t&&(t={}),c={data:t.data||{},error:t.error||h,success:t.success||h,beforeSend:t.beforeSend||h,complete:t.complete||h,url:t.url||""},c.computedUrl=r(c),0===c.url.length)throw new Error("MissingUrl");return n=!1,!1!==c.beforeSend({},c)&&(i=t.callbackName||"callback",s=t.callbackFunc||"jsonp_"+d(15),e=c.data[i]=s,window[e]=function(t){return window[e]=null,c.success(t,c),c.complete(t,c)},(u=o("script")).src=r(c),u.async=!0,u.onerror=function(t){return c.error({url:u.src,event:t}),c.complete({url:u.src,event:t},c)},u.onload=u.onreadystatechange=function(){var t,e;if(!(n||"loaded"!==(t=this.readyState)&&"complete"!==t))return n=!0,u?(u.onload=u.onreadystatechange=null,null!=(e=u.parentNode)&&e.removeChild(u),u=null):void 0},(a=window.document.getElementsByTagName("head")[0]||window.document.documentElement).insertBefore(u,a.firstChild)),{abort:function(){if(window[e]=function(){return window[e]=null},n=!0,null!=u?u.parentNode:void 0)return u.onload=u.onreadystatechange=null,u.parentNode.removeChild(u),u=null}}},h=function(){},r=function(t){var e;return e=t.url,e+=t.url.indexOf("?")<0?"?":"&",e+=c(t.data)},d=function(t){var e;for(e="";e.length<t;)e+=u().toString(36).slice(2,3);return e},c=function(t){var e,s;return function(){var i;i=[];for(e in t)s=t[e],i.push(a(e)+"="+a(s));return i}().join("&")},(null!==s(4)?s(5):void 0)?void 0!==(i=function(){return n}.call(e,s,e,t))&&(t.exports=i):(void 0!==t&&null!==t?t.exports:void 0)?t.exports=n:this.JSONP=n}).call(this)}).call(e,s(3)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})}]);